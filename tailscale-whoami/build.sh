#!/bin/bash

mkdir -p "/etc/docker/certs.d/registry.caddy-system.svc.cluster.local:443"

echo -n "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvVENDQWVXZ0F3SUJBZ0lSQU1DcnA2UHZFcGQvUFA0RHMvdUowOWt3RFFZSktvWklodmNOQVFFTEJRQXcKQURBZUZ3MHlNekEwTURVeE5UUXhNRFphRncweU16QTNNRFF4TlRReE1EWmFNQUF3Z2dFaU1BMEdDU3FHU0liMwpEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUM0K1h4d3lGcGRiMnNSdDNzZVk5ZVNpbVMxb3NQbFpWMStsc2VoCnIvLy9xbGwxcTF3Y25qMWZvdEs3RFltWm5tVVloaThLNXYyaTVKVHcwV2lUUlA2MFp4RHFVSmV1WUJXSTRGcTAKbjFXc095QzBXWkNtNERxRzBRM1FHSklnTXZ3UEpqY0t1dVE5c0xiZUFqWEJmNXVKWDM2SUx6am9BOEYzOW5pSgpWYm1KcCtIRFlNVnFJQU1xc211cWJIODZGSk5xWjYrWjVjSUJLWEozT09QR3M1cENXQnpldWEzeHVVTG9CUnloCjREVHB2KzRhdmRmd3pJYjJLUDMybXA0SEdDQ01KRXdGcktUYkVvMmxZMWZZTFAzaXJOL251d3VYS1AvaWFXdzcKcFZ0eTVMZGtoZlorUmEzMUt4LzhzOUZYSEVWVFRsSm03QnJ0QWxXcTY1Zm85d1hWQWdNQkFBR2pjakJ3TUE0RwpBMVVkRHdFQi93UUVBd0lGb0RBTUJnTlZIUk1CQWY4RUFqQUFNRkFHQTFVZEVRRUIvd1JHTUVTQ0dYSmxaMmx6CmRISjVMbU5oWkdSNUxYTjVjM1JsYlM1emRtT0NKM0psWjJsemRISjVMbU5oWkdSNUxYTjVjM1JsYlM1emRtTXUKWTJ4MWMzUmxjaTVzYjJOaGJEQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFsUms1V0NDRVVydFJPVmJqeWIxdgo3Z0ZLT1ZydGhla3hQNGFWeXgyNmpxUENIV1hhM05iUzBxWDNRTUR5bWhFUjE4SjZ2cTZ5YWVmTkgvNzdjNWZECnd6bDNPNmY2VEFKblFLckFkY1JXc2FZUEMyUXdoNCtObFhZZ2lPMnd2SjFlcG1QOWNLWFBrUXVZTlBvWlVIcnAKeEdMT0JjOEwwcUdUcEVCdWNUbmpQekxjcDE2ejR2cE5OZnRkZEE0aS9vUkhlemUvbnpQOVdRQUN1VzNuV0E0MwpEaExHYlFRNVo5cHFPQVZ2Y3B2cnhnYWVObGd4RnhUSE9yV1NFL2c2S0MzRFZzNVZNZ3ZRT2xKSDVXdFF2Nk1QCmh0ekRIUURUek5RMmNqcEh4alEzNTl1RzNSbVdhNjVmSUlOUVloUXJna1VncytUKzFUT0pSSTRLVEl3OTU3SSsKMHc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==" | \
    base64 --decode > "/etc/docker/certs.d/registry.caddy-system.svc.cluster.local:443/ca.crt"

docker build -f Containerfile -t registry.caddy-system.svc.cluster.local/whoami:latest .
docker push registry.caddy-system.svc.cluster.local/whoami:latest

#docker build -f Containerfile -t registry.unicorn-alligator.ts.net/whoami:latest .
#docker push registry.unicorn-alligator.ts.net/whoami:latest